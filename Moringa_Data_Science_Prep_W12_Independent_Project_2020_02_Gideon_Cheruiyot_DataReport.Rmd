---
title: "Moringa_Data_Science_Prep_W12_Independent_Project_2020_02_Gideon_Cheruiyot_DataReport"
author: "Gideon Cheruiyot"
date: "28/02/2020"
output: html_document
---

```
```

# roblem statement: I dentify individuals who are more likely to click on the Ads posted on his/her blog
# etrics of success: our success will be measured by our ability to identify attributes of the the users who click the adverts.
# Data relevance
*The appropriateness of the data will be addressed by checking:*
+ whether the data is accurate? 
+ whether the dataset is enough to sufficiently address the problem at hand?
+  whether the dtaset was biased or imbalanced?
# Experimental design:
* loading and previewing the dataset
* Cleaning , checking for outliers 
* Conducting exploratory data analysis to find out patterns and relationships
* Comunicating the obsertavtions and findings
* Drawing conclusion

#Challenging the solution.
More analysis need to be done to clearly predict the person likely to click on the Ad, this may include modeling for instance incorporating a logistic regression model.

##Loading  the dataset
```{r}
data <- read.csv( 'advertising.csv')
head(data)
```
## Understanding the datatypes for our features
```{r}
str(data)
```
## Finding any missing values
```{r}
colSums(is.na(data))
```
## Exploratory Data Analysis
## Univariate analysis
```{r}
summary(data)
```

# Finding outliers
*could not find any outliers*
```{r}
Dt_spent <- data$Daily.Time.Spent.on.Site
dt_clicked <- data$Clicked.on.Ad
par(mfrow=c(2,2))
hist(Dt_spent,xlab = 'daily time spent on the site', main = 'daily time spent on the site' )
boxplot(Dt_spent,xlab = 'daily time spent on the site', horizontal=TRUE)
hist(dt_clicked, xlab = 'clicked on the Ad', ylab = 'freuency',main = 'clicks on the Ad')
boxplot(dt_clicked, xlab = 'clicked on the Ad', ylab = 'freuency', horizontal=TRUE)
```
*on Average people spent an 65 minutes on the site on a daily basis and a maximum of 88 minutes.
*clicks on the the Ad are balanced, the number of people who clicked and those who did not click on the AD are equal.



**values that are deemed to be outliers in the area income feature**
```{r}
a_income <- data$Area.Income
d_internet_usage <- data$Daily.Internet.Usage
par(mfrow=c(2,2))
hist(a_income,xlab = 'area income', main = 'income' )
boxplot(a_income,xlab = 'area income', horizontal=TRUE)
hist(d_internet_usage, xlab = 'minutes', ylab = 'freuency',main = 'Daily internet usage')
boxplot(d_internet_usage, xlab = 'minutes', ylab = 'freuency', horizontal=TRUE)
boxplot.stats(data$Area.Income)$out
```
*The maximum  area income was approximately 8,000 and an average of between 5,000 and 6,000.

**found no outliers in the daily internet usage**
*The outliers were retained due to the fact that, different countries have different range of income and they appear to be normal, there are low and  high income earning countries.

# Feature enginering to allow analysis based on time and date.*
* first step was to split the Timestap into 'Date' and 'Time'*
* then conerted them into Date and Time formats respectively*
```{r}
data$Date <- sapply(strsplit(as.character(data$Timestamp), " "), "[", 1)
data$Time <- sapply(strsplit(as.character(data$Timestamp), " "), "[", 2)
```
```{r}
date <- as.Date(data$Date)
Time <- as.POSIXct(data$Time,format="%H:%M:%S")

```

```{r}

par(mfrow=c(1,2))
#plot.ts(date,xlab = 'area income', main = 'income' )
boxplot(date,xlab = 'area income', horizontal=TRUE)
#plot.ts(Time, xlab = 'minutes', ylab = 'freuency',main = 'Daily internet usage')
boxplot(Time, xlab = 'seconds', ylab = 'freuency', horizontal=TRUE)

```
*There were no outliers, for Date and Time.
# Bivariate analysis
```{r}
colnames(data)
```


```{r}
#scat.raw.melt <- data$melt(measure.vars = 1:4)
library(ggplot2)
library(dplyr)
par(mfrow=c(2,2))

ggplot(data = data) + 
  geom_point(mapping = aes(x = Clicked.on.Ad ,  y= Daily.Time.Spent.on.Site))
ggplot(data = data) + 
  geom_point(mapping = aes(x = Clicked.on.Ad ,  y= Age))
ggplot(data = data) + 
  geom_point(mapping = aes(x = Clicked.on.Ad ,  y= Area.Income))
ggplot(data = data) + 
  geom_point(mapping = aes(x = Clicked.on.Ad ,  y= Daily.Internet.Usage))
  
```
*users who spend less than 50 minutes in the site on a daily basis are more likely to click on the Ads. While people with less than 150 minutes on the internet are more likely to click on the Ads.
*Age does not have much influence on the likelihood of one clicking the Ads, however, older people above 50 years are more likely to click on the Ads.
* people from low area income of below 3,000 are more likely to click on the Ads
```{r}
factor <- factor(data$Country)
as.numeric(factor)
summary(data)
```

#multivariate Analysis
```{r}
sub_data <- c('Clicked.on.Ad', 'Male', 'Age', 'Area.Income', 'Daily.Internet.Usage', 'Daily.Time.Spent.on.Site')
num <- data[,sub_data]
num_cor <- cor(num)
library(corrplot)
corrplot(num_cor)
```
*There is a strong positive correlation between Age and the those who clicked the AD,hence the older the user the more likely he/she will click the ad.*
*Daily inter usage and Daily time spent o the site has a strong negative correlation to Clicking the Ad.Thus, the less time one spents on both the site and the internet he/she will be more likely to click on the Ads.*
*Gender(Rep' by - 'Male') has no correlation to the likelihood of one clicking  the Ad.*
*Area income as weak positive corelation with the the likelihood of one clicking the Ad, suggesting that , the higher the area income the more likely that the person will clkick on the Ad.*







